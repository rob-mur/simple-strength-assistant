---
phase: 04-swipeable-tape-measure
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified: ["src/app.rs"]
autonomous: false
requirements: ["TAPE-01", "TAPE-02", "INT-01", "INT-02", "INT-03"]
user_setup: []

must_haves:
  truths:
    - "TapeMeasure replaces Weight and Reps inputs in ActiveSession"
    - "Values are correctly synced with WorkoutState"
    - "Playground view exists to tune physics constants"
    - "UI is responsive and sized for thumb interaction (mobile dimensions)"
  artifacts:
    - path: "src/app.rs"
      provides: "Integrated UI with TapeMeasure components"
---

<objective>
Integrate the TapeMeasure component into the main application, replacing existing inputs and providing a playground for fine-tuning the "feel".

Purpose: To deliver a fully tactile workout recording experience as part of v1.1.
Output: An updated application UI with swipeable Reps and Weight inputs.
</objective>

<execution_context>
@./.gemini/get-shit-done/workflows/execute-plan.md
@./.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/milestones/v1.1-phases/04-swipeable-tape-measure/04-CONTEXT.md
@.planning/milestones/v1.1-phases/04-swipeable-tape-measure/04-RESEARCH.md
@.planning/phases/04-swipeable-tape-measure/04-02-SUMMARY.md
@src/app.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TapeMeasure Playground and Tune Physics</name>
  <files>src/app.rs</files>
  <action>
    - Add a temporary `TapeMeasurePlayground` component to `src/app.rs` or a separate module.
    - Include sliders to adjust: `friction`, `acceleration_mult`, `pixels_per_step`, `snap_threshold`.
    - Manually tune these variables to achieve the "Roulette wheel" glide mentioned in CONTEXT.md.
    - Once tuned, hardcode these values as defaults in `TapeMeasure`.
  </action>
  <verify>
    Playground allows for interactive tuning and immediate feedback on "feel".
  </verify>
  <done>
    Physics constants tuned for optimal tactile feel.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace Weight and Reps inputs in ActiveSession</name>
  <files>src/app.rs</files>
  <action>
    - In `ActiveSession`, replace the `input type="number"` for Weight and Reps with the `TapeMeasure` component.
    - Pass appropriate `min`, `max`, and `step` values from the `session.predicted` or `exercise.set_type_config`.
    - For Weight: `step` is typically 0.5 or 2.5 (from config).
    - For Reps: `step` is 1.0.
    - Ensure `TapeMeasure` is sized for mobile thumb interaction (INT-02).
  </action>
  <verify>
    TapeMeasure components appear and correctly update the state in ActiveSession.
  </verify>
  <done>
    UI inputs replaced with tactile TapeMeasure components.
  </done>
</task>

<task type="auto">
  <name>Task 3: Synchronize with Global WorkoutState</name>
  <files>src/app.rs</files>
  <action>
    - Connect the `on_change` event of each `TapeMeasure` to update the local signals in `ActiveSession`.
    - Ensure the "Log Set" button uses the values provided by the `TapeMeasure` components.
    - Satisfy INT-03 (Synchronize with global state).
  </action>
  <verify>
    Logging a set correctly captures the value selected on the tape measure.
  </verify>
  <done>
    Full data synchronization between UI and global state completed.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Fully integrated Swipeable Tape Measure for Weight and Reps.</what-built>
  <how-to-verify>
    1. Start a workout session.
    2. Drag the Weight tape measure; it should glide and snap smoothly.
    3. Drag the Reps tape measure; it should behave similarly.
    4. Click a number on the tape to jump to it.
    5. Click "Log Set" and verify the correct values appear in the completed sets list.
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
Perform end-to-end verification of the recording flow using the new tactile components.
</verification>

<success_criteria>
- No typing required to set weight or reps.
- UI is responsive and "feels" high-quality on a mobile viewport.
- Data persistence works as expected.
</success_criteria>

<output>
After completion, create `.planning/phases/04-swipeable-tape-measure/04-03-SUMMARY.md`
</output>
