---
phase: 01-development-environment
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/main.rs
  - Cargo.toml
autonomous: false
requirements:
  - DEV-01
  - DEV-02
  - DEV-03
  - DEV-04

must_haves:
  truths:
    - "Development server runs and serves app in browser"
    - "Browser console displays initialization logs from Dioxus logger"
    - "WASM module loads successfully without compilation errors"
    - "Hot reload responds to RSX markup changes"
  artifacts:
    - path: "src/main.rs"
      provides: "Logger initialization before app launch"
      contains: "dioxus::logger::init"
      min_lines: 12
    - path: "Cargo.toml"
      provides: "Tracing dependency for Dioxus logger"
      contains: "tracing"
  key_links:
    - from: "src/main.rs"
      to: "dioxus::logger"
      via: "init call before launch"
      pattern: "dioxus::logger::init.*\\n.*dioxus::launch"
    - from: "Browser console"
      to: "Rust log calls"
      via: "tracing-wasm bridge"
      pattern: "console output when app loads"
---

<objective>
Set up development environment with console debugging capabilities for diagnosing the file picker issue.

Purpose: Enable browser-based debugging by initializing the Dioxus logger so that existing `log::*` calls throughout the codebase output to the browser console. This is essential for capturing error messages and state transitions needed to debug the File System Access API integration.

Output: Running dev environment with visible console logs, hot-reload enabled, and WASM compilation working.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-development-environment/01-RESEARCH.md

# Codebase Context
@.planning/codebase/STACK.md
@.planning/codebase/STRUCTURE.md
@.planning/codebase/CONVENTIONS.md

# Key Source Files
@src/main.rs
@Cargo.toml
@Dioxus.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Dioxus logger for console debugging</name>
  <files>src/main.rs, Cargo.toml</files>
  <action>
Add the `tracing` dependency to `Cargo.toml` under `[dependencies]`:
```toml
tracing = "0.1"
```

Update `src/main.rs` to initialize the Dioxus logger before launching the app:
```rust
mod app;
mod models;
mod state;

use app::App;

fn main() {
    // Initialize logger with Debug level for development
    // This routes all log::* calls throughout the codebase to browser console via tracing-wasm
    dioxus::logger::init(tracing::Level::DEBUG)
        .expect("failed to init logger");

    dioxus::launch(App);
}
```

**Why this works**: The existing codebase already uses `log::error!()` and `log::warn!()` macros in many places (db.rs, file_system.rs, workout_state.rs), but the log facade has no backend configured. Dioxus logger automatically uses `tracing-wasm` for the web target, which bridges to `console.log()`. Once initialized, all existing log calls will appear in browser DevTools.

**Why Debug level**: Captures all log levels (trace, debug, info, warn, error) which is necessary for development debugging. In production, this would be set to Info or Warn.
  </action>
  <verify>
1. `cargo check --target wasm32-unknown-unknown` passes with no errors
2. `grep -n "dioxus::logger::init" src/main.rs` shows logger initialization
3. `grep -n "tracing" Cargo.toml` shows tracing dependency added
  </verify>
  <done>
- `src/main.rs` contains logger initialization before `dioxus::launch()`
- `Cargo.toml` includes `tracing = "0.1"` dependency
- Code compiles successfully for wasm32-unknown-unknown target
  </done>
</task>

<task type="auto">
  <name>Task 2: Start development server and verify WASM compilation</name>
  <files>N/A - runtime verification</files>
  <action>
Start the Dioxus development server:
```bash
dx serve --port 8080 --open false
```

Wait for the build to complete. The output should show:
- Cargo compilation succeeding
- WASM bindings generation completing
- Development server starting on http://localhost:8080
- "Serving app at..." message

**Why these flags**:
- `--port 8080`: Explicit port (Dioxus default)
- `--open false`: Don't auto-open browser (we'll verify manually next)

The server includes hot-reload by default for RSX markup and assets. Full Rust hot-patching (`--hotpatch`) is not needed for this phase.

Leave the server running for the next task's manual verification.
  </action>
  <verify>
1. `dx serve --port 8080 --open false` runs without errors
2. Terminal shows "Serving app at http://localhost:8080" or similar success message
3. No WASM compilation errors in output
4. Server stays running (doesn't exit or crash)
  </verify>
  <done>
- Development server is running on http://localhost:8080
- WASM compilation completed successfully
- No errors in terminal output
- Server responds to requests
  </done>
</task>

<task type="checkpoint:human-verify">
  <name>Task 3: Verify console logging and hot-reload functionality</name>
  <files>N/A - manual verification</files>
  <action>
Verify the development environment is fully functional with console debugging capabilities enabled. This checkpoint confirms that all Phase 1 requirements are met and the environment is ready for Phase 2 debugging work.
  </action>
  <verify>
**Manual verification steps:**

1. **Open browser**: Navigate to http://localhost:8080
2. **Open DevTools console**: Press F12 or right-click → Inspect → Console tab
3. **Check app loads**: UI should render (you should see the workout assistant interface)
4. **Check console logs**: Look for initialization logs in the console. You should see:
   - Log messages from app initialization (from `src/app.rs`)
   - Log messages with `[DB Init]`, `[FileSystem]`, or similar prefixes
   - Any error messages (if initialization fails - this is what we need to debug the file picker)
5. **Verify log levels**: Messages should show with different severity levels (debug, info, warn, error)
6. **Test hot-reload** (optional but recommended):
   - Open `src/app.rs` in an editor
   - Change some text in an RSX element (e.g., a button label)
   - Save the file
   - Browser should update within 1-2 seconds without full page refresh

**Expected outcome**: App loads, console shows detailed logs from Rust code, and you can see what's happening during initialization. This gives us the debugging visibility needed to diagnose the file picker issue in Phase 2.

**If logs don't appear**: This would indicate the logger isn't properly initialized or there's an issue with tracing-wasm. Report what you see (or don't see) in the console.

**If app doesn't load**: Check for errors in both terminal (server output) and browser console. This could indicate WASM loading issues or JavaScript bridge problems.
  </verify>
  <done>
Type "verified" if console logs appear and app loads correctly.

If you see issues, describe what you see:
- "no logs" - app loads but console is empty
- "wasm error: [message]" - WASM fails to load
- "blank screen" - app doesn't render
- "other: [description]" - any other issues observed
  </done>
</task>

</tasks>

<verification>
After completion, verify:

**Development Environment (DEV-01):**
- [ ] `dx serve` command runs without errors
- [ ] Server starts and stays running
- [ ] http://localhost:8080 is accessible

**Console Access (DEV-02):**
- [ ] Browser DevTools console shows Rust log messages
- [ ] Log levels are visible (debug, info, warn, error)
- [ ] Initialization sequence is visible in console

**WASM Compilation (DEV-03):**
- [ ] `cargo check --target wasm32-unknown-unknown` passes
- [ ] `dx serve` completes WASM build without errors
- [ ] WASM module loads in browser (check Network tab for .wasm file)

**Hot Reload (DEV-04):**
- [ ] RSX changes (text, attributes) reflect in browser within seconds
- [ ] No manual browser refresh needed for markup changes
- [ ] Terminal shows "Hot reloading..." messages on file changes
</verification>

<success_criteria>
1. **Development server runs**: `dx serve` successfully starts and serves the app
2. **App loads in browser**: UI renders at http://localhost:8080
3. **Console logs visible**: Browser console shows initialization logs from Rust code
4. **WASM works**: No WASM load errors, app is interactive
5. **Hot reload responds**: File changes trigger automatic browser updates

All four phase requirements (DEV-01 through DEV-04) are satisfied, enabling effective debugging for Phase 2's file picker investigation.
</success_criteria>

<output>
After completion, create `.planning/phases/01-development-environment/01-01-SUMMARY.md`
</output>
